<!DOCTYPE html>

<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>Geodesics Boogaloo</title>

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
	<script src="../js/katexConfig.js"></script>

	<script src="https://cdn.plot.ly/plotly-gl3d-latest.min.js"></script>

	<script src="../js/matrix.js"></script>
	<script src="../js/12-7-20.js"></script>

	<link rel="stylesheet" type="text/css" href="../style/post.css">
	<link rel="stylesheet" type="text/css" href="../style/nav.css">
	<link rel="stylesheet" type="text/css" href="../style/12-7-20.css">

</head>

<nav>
	<ul>
		<li>Mitchell Riley</li>
		<li><a href="../index.html">Posts</a></li>
		<li><a href="../about.html">About</a></li>
	</ul>
</nav>

<hr>

<body>
	<h1>Geodesics Boogaloo</h1>
	<div id="date">
		December 7, 2020
	</div>
<br>

<a href="../posts/01-12-20.html">Some posts back</a> I was trying to solve the boundary value problem associated with toroidal geodesics, and I ran into some problems. The crux of these issues what that I was trying to satisfy the default geodesic equations on the arbitrary interval $(0,1)$, when in actuality there was no mathematical basis in choosing that. The fix for this is the inclusion of a simple theorem:

<br><br>

<b>Theorem</b>: A geodesic has constant speed.
<br>
$\mathit{Proof.}$ Let $\gamma(t)$ be a geodesic on a surface $S$.
$$\frac{d}{dt}\lVert\gamma'\rVert^2 = \frac{d}{dt}(\gamma'\cdot\gamma') =\gamma''\cdot\gamma' + \gamma''\cdot\gamma' = 2\gamma''\cdot\gamma'$$
Since $\gamma''$ is by definition perpendicular to $S$, it is also perpendicular to the tangent vector $\gamma'$, so $\gamma''\cdot\gamma'=0$. Therefore $\frac{d}{dt}\lVert\gamma'\rVert^2 = 0$ and

$$
\begin{aligned}
\lVert\gamma'\rVert^2&=c\\
\lVert\gamma'\rVert&=\sqrt{c}
\end{aligned}
$$

for some constant $c$. $\Box$

<br><br>

A geodesic $\gamma(t)$ on a torus $\sigma$ is defined by

$$
\gamma(t) =\sigma(\theta(t),\phi(t)) = \begin{bmatrix}
    \cos(\theta(t))(R+r\cos(\phi(t))) \\
    \sin(\theta(t))(R+r\cos(\phi(t))) \\
    r\sin(\phi(t)) \\
\end{bmatrix}
$$

Since any geodesic has constant speed, we might as well consider geodesics with unit-speed, meaning $\lVert\gamma'\rVert=1$. What is $\lVert\gamma'\rVert$? With some applications of the chain rule,

$$
\begin{aligned}
\lVert\gamma'\rVert^2 = (R+r\cos\theta)^2d\theta^2 + r^2d\phi^2 \\
1^2 = (R+r\cos\theta)^2d\theta^2 + r^2d\phi^2.
\end{aligned}
$$

With this new information, we can modify the standard geodesic equations.
The geodesic equations are again

$$
\begin{gathered}
\theta''=\frac{2r\sin\phi}{R+r\cos\phi}\phi'\theta' \\
\phi'' = -\frac{1}{r}\sin\phi(R+r\cos\phi)(\theta')^2.
\end{gathered}
$$

With the substitution $(\theta')^2=\frac{1-r^2d\phi^2}{(R+r\cos\phi)^2}$, the equations become

$$
\begin{gathered}
\theta''=\frac{2r\sin\phi}{R+r\cos\phi}\phi'\theta' \\
\phi'' = -\frac{\sin\phi(1-(r\phi')^2)}{r(R+r\cos\phi)}.
\end{gathered}
$$

We can describe the boundary value problem using these new equations
$$
\begin{aligned}
\text{ODEs} \qquad
&\left\{\begin{aligned}
\theta''&=\frac{2r\sin(\phi)}{R+r\cos(\phi)}\phi'\theta' \\
\phi'' &= -\frac{\sin\phi(1-(r\phi')^2)}{r(R+r\cos\phi)}
\end{aligned}\right. \\

\text{BCs} \qquad
&\left\{\begin{aligned}
\theta(0)&=\alpha_0 & \theta(b)&=\beta_0 \\
\phi(0)&=\alpha_1 & \phi(b)&=\beta_1.
\end{aligned}\right.
\end{aligned}
$$

Note that this time, a choice of $(0,1)$ makes sense because the unit-speed condition guarantees that the BVP can be satisfied on this interval. In fact, any interval $(0,b)$ will work. To justify this, we must look at the arc-length of $\gamma$, which is given by $$s=\int_{t_0}^t \lVert \gamma'(t) \rVert \, dt.$$

Since we are integrating from $0$ to $b$, and $\gamma$ has unit-speed,

$$
\begin{aligned}
s &= \int_{t_0}^t \lVert \gamma'(t) \rVert \, dt \\
s &= \int_0^b 1 \, dt \\
s &= b.
\end{aligned}
$$

The length of $\gamma$ directly depends on the length of the interval, so it is just as well that we let $b=1$.

<br><br>

...atleast, in theory we should be able to do that. In my testing, RKF45 could handle any BVP where $b=1$, but it becomes unstable when $b>5$ or so. This was not the case when I tested this same solution process in Julia, which has a much more sophisticated ODE solver suite. Julia actually has the ability to <a href="https://diffeq.sciml.ai/stable/solvers/ode_solve/#CompositeAlgorithm">on-the-fly switch what solver it is using</a> when the step-size becomes too small. For this particular system, DifferentialEquations.jl chose a combination of <code>TSit5</code> which is an RK45 variant, and <code>Rosenbrock23</code> which is a powerful solver for stiff systems. I have included a little tester below to play around with.

<br><br>

<div id="plot"></div>
<div id="plotContainer">
	<div id="options1">
		$\theta(0)=$ <input type="text" size="1" id="alpha0" value="0">
		$\theta($<input type="text" size="1" id="b0" value="1">$)=$ <input type="text" size="1" id="beta0" value="3.14">
		<br>
		$\phi(0)=$ <input type="text" size="1" id="alpha1" value="1.57">
		$\phi($<input type="text" size="1" id="b1" value="1">$)=$ <input type="text" size="1" id="beta1" value="1.57">
	</div>
	<button type="button" id="plotButton">Plot</button>
	<div id="error"></div>
</div>
